---
description: Easy - Linux / ISPConfig v3.2.10p1 / PHP代码注入
---

# ✔️ CVE-2023-46818

## 建立立足点

### 信息收集

* 使用Nmap对目标系统的开放端口进行扫描，获取到4个开放端口：22 / 80 / 8080 / 8081

```bash
nmap -sC -sV -oA cve46818 192.168.235.101 --open
```

<figure><img src="../../.gitbook/assets/1 (38).png" alt=""><figcaption></figcaption></figure>

* 检查a80端口上的内容，发现是ISPConfig的登录界面，尝试弱口令登录成功：**admin : admin**

<figure><img src="../../.gitbook/assets/2 (37).png" alt=""><figcaption></figcaption></figure>

* 并且找到了当前正在运行的软件及其版本号：**ISPConfig Version: 3.2.10p1**

<figure><img src="../../.gitbook/assets/3 (34).png" alt=""><figcaption></figcaption></figure>

* 枚举80端口上的隐藏文件/目录，依次查看没有什么特别的收获：

```bash
dirsearch -u http://192.168.200.101 -x 404,403,401,302,301,400
```

<figure><img src="../../.gitbook/assets/7 (35).png" alt=""><figcaption></figcaption></figure>

* 检查和枚举了其他端口上的内容，没有什么收获：

<figure><img src="../../.gitbook/assets/5 (35).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/6 (37).png" alt=""><figcaption></figcaption></figure>

### 漏洞查阅

* 根据已经得知的软件版本号ISPConfig Version: 3.2.10p1，进行公开漏洞查找：

<figure><img src="../../.gitbook/assets/8 (33).png" alt=""><figcaption></figcaption></figure>

### 漏洞利用

*   exploit.py：

    <figure><img src="../../.gitbook/assets/11 (30).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/12 (29).png" alt=""><figcaption></figcaption></figure>

### ROOT

* 直接利用该exploit.py脚本和已知的弱口令admin:admin,即可获得shell：

```bash
python3 exploit.py http://192.168.235.101 admin admin
```

<figure><img src="../../.gitbook/assets/9 (32).png" alt=""><figcaption></figcaption></figure>

* 获取到了proof.txt文本内容：

<figure><img src="../../.gitbook/assets/10 (33).png" alt=""><figcaption></figcaption></figure>
